<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.29" />
    <meta name="description" content="">


    <title>Tutorial :: Outcome documentation</title>
    <link rel="shortcut icon" href="/outcome/images/favicon.png" type="image/x-icon" />
    <link href="/outcome/css/nucleus.css" rel="stylesheet">
    <link href="/outcome/css/font-awesome.min.css" rel="stylesheet">
    <link href="/outcome/css/hybrid.css" rel="stylesheet">
    <link href="/outcome/css/featherlight.min.css" rel="stylesheet">
    <link href="/outcome/css/horsey.css" rel="stylesheet">
    
    <link href="/outcome/css/theme.css" rel="stylesheet">
    
    
    <link rel="stylesheet" href="/outcome/css/bootstrap.min.css">
    <script src="/outcome/js/jquery-2.x.min.js"></script>
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left {
        display:none !important;
      }
    </style>

    

    <link href="/outcome/css/local.css" rel="stylesheet">

  </head>
  <body class="" data-url="/outcome/tutorial/">
    <nav id="sidebar" class=""><div class="highlightable">
  <div id="header-wrapper">
    <div id="header"> 
	<p>Outcome 2.0 library documentation</p>
 


    </div><div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>
<script type="text/javascript" src="/outcome/js/lunr.min.js"></script>
<script type="text/javascript" src="/outcome/js/horsey.js"></script>
<script type="text/javascript">
    var baseurl = "https:\/\/ned14.github.io\/outcome\/";
</script>
<script type="text/javascript" src="/outcome/js/search.js"></script>

  </div>


    <ul class="topics">
            <li data-nav-id="/outcome/" class="dd-item">
            <a href="/outcome/"><i class="fa fa-fw fa-home"></i></a>
            </li>
    <li data-nav-id="/outcome/requirements/" class="dd-item">
      <a href="/outcome/requirements/">
        <span>Prerequisites</span>
      </a>
    </li>
    <li data-nav-id="/outcome/build/" class="dd-item">
      <a href="/outcome/build/">
        <span>Build and install</span>
      </a>
    </li>
    <li data-nav-id="/outcome/tutorial/" class="dd-item parent active">
      <a href="/outcome/tutorial/">
        <span>Tutorial</span>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </a>
        <ul>
    <li data-nav-id="/outcome/tutorial/result/" class="dd-item">
      <a href="/outcome/tutorial/result/">
        <span>result&lt;T, EC&gt;</span><i class="fa fa-angle-right fa-lg category-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/outcome/tutorial/result/inspecting/" class="dd-item">
        <a href="/outcome/tutorial/result/inspecting/">
          <span>Inspecting result&lt;T, EC&gt;</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/result/try/" class="dd-item">
        <a href="/outcome/tutorial/result/try/">
          <span>TRY operations</span>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/outcome/tutorial/outcome/" class="dd-item">
      <a href="/outcome/tutorial/outcome/">
        <span>outcome&lt;T, EC, EP&gt;</span><i class="fa fa-angle-right fa-lg category-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/outcome/tutorial/outcome/inspecting/" class="dd-item">
        <a href="/outcome/tutorial/outcome/inspecting/">
          <span>Inspecting outcome&lt;T, EC, EP&gt;</span>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/outcome/tutorial/payload/" class="dd-item">
      <a href="/outcome/tutorial/payload/">
        <span>outcome&lt;T, EC, P&gt;</span><i class="fa fa-angle-right fa-lg category-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/outcome/tutorial/payload/copy_file/" class="dd-item">
        <a href="/outcome/tutorial/payload/copy_file/">
          <span>The Filesystem TS</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/payload/copy_file2/" class="dd-item">
        <a href="/outcome/tutorial/payload/copy_file2/">
          <span>Upgrading the Filesystem TS</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/payload/copy_file3/" class="dd-item">
        <a href="/outcome/tutorial/payload/copy_file3/">
          <span>Throwing filesystem_error</span>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/outcome/tutorial/default-actions/" class="dd-item">
      <a href="/outcome/tutorial/default-actions/">
        <span>Default actions</span><i class="fa fa-angle-right fa-lg category-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/outcome/tutorial/default-actions/udt-err/" class="dd-item">
        <a href="/outcome/tutorial/default-actions/udt-err/">
          <span>User defined error types</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/default-actions/happens1/" class="dd-item">
        <a href="/outcome/tutorial/default-actions/happens1/">
          <span>-- What happens?</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/default-actions/enums/" class="dd-item">
        <a href="/outcome/tutorial/default-actions/enums/">
          <span>Error code enums</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/default-actions/happens2/" class="dd-item">
        <a href="/outcome/tutorial/default-actions/happens2/">
          <span>-- What happens?</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/default-actions/happens3/" class="dd-item">
        <a href="/outcome/tutorial/default-actions/happens3/">
          <span>-- Now what happens?</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/default-actions/error-codes/" class="dd-item">
        <a href="/outcome/tutorial/default-actions/error-codes/">
          <span>error_code</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/default-actions/exception-ptr/" class="dd-item">
        <a href="/outcome/tutorial/default-actions/exception-ptr/">
          <span>exception_ptr</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/default-actions/void/" class="dd-item">
        <a href="/outcome/tutorial/default-actions/void/">
          <span>void</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/default-actions/unchecked/" class="dd-item">
        <a href="/outcome/tutorial/default-actions/unchecked/">
          <span>unchecked&lt;T, E&gt; and checked&lt;T, E&gt;</span>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/outcome/tutorial/hooks/" class="dd-item">
      <a href="/outcome/tutorial/hooks/">
        <span>Hooking events</span><i class="fa fa-angle-right fa-lg category-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/outcome/tutorial/hooks/keeping_state/" class="dd-item">
        <a href="/outcome/tutorial/hooks/keeping_state/">
          <span>Keeping state</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/hooks/adl_bridging/" class="dd-item">
        <a href="/outcome/tutorial/hooks/adl_bridging/">
          <span>ADL bridging</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/hooks/hook_result/" class="dd-item">
        <a href="/outcome/tutorial/hooks/hook_result/">
          <span>Hook result</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/hooks/poke_exception/" class="dd-item">
        <a href="/outcome/tutorial/hooks/poke_exception/">
          <span>Custom exception ptr</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/hooks/hook_outcome/" class="dd-item">
        <a href="/outcome/tutorial/hooks/hook_outcome/">
          <span>Hook outcome</span>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/outcome/tutorial/policies/" class="dd-item">
      <a href="/outcome/tutorial/policies/">
        <span>Policies</span><i class="fa fa-angle-right fa-lg category-icon"></i>
      </a>
        <ul>
      <li data-nav-id="/outcome/tutorial/policies/anatomy/" class="dd-item">
        <a href="/outcome/tutorial/policies/anatomy/">
          <span>Anatomy of a policy</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/policies/cast/" class="dd-item">
        <a href="/outcome/tutorial/policies/cast/">
          <span>Casting workaround</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/policies/universal/" class="dd-item">
        <a href="/outcome/tutorial/policies/universal/">
          <span>Result &#43; Outcome</span>
        </a>
    </li>
      <li data-nav-id="/outcome/tutorial/policies/result-policies/" class="dd-item">
        <a href="/outcome/tutorial/policies/result-policies/">
          <span>Result</span>
        </a>
    </li>
        </ul>
    </li>
      <li data-nav-id="/outcome/tutorial/error_code/" class="dd-item">
        <a href="/outcome/tutorial/error_code/">
          <span>Custom error codes</span>
        </a>
    </li>
        </ul>
    </li>
    <li data-nav-id="/outcome/faq/" class="dd-item">
      <a href="/outcome/faq/">
        <span>Frequently asked questions</span>
      </a>
    </li>
    <li data-nav-id="/outcome/history/" class="dd-item">
      <a href="/outcome/history/">
        <span>History</span>
      </a>
    </li>
        <section id="shortcuts">
                <li class="" role=""><a href="/outcome/standardese/standardese_entities.html" target="_blank" rel="noopener">API reference (standardese)</a></li>
                <li class="" role=""><a href="/outcome/doxygen/namespaceoutcome__v2__xxx.html" target="_blank" rel="noopener">API reference (doxygen)</a></li>
                <li class="" role=""><h3>More</h3><a href="https://github.com/ned14/outcome" target="_blank" rel="noopener"><i class='fa fa-github'></i> Outcome 2.0 github repo</a></li>
                <li class="" role=""><a href="/outcome/credits" target="_blank" rel="noopener"><i class='fa fa-bullhorn'></i> Acknowledgements</a></li>
        </section>
    </ul>


    <section id="footer"><center>

<a class="github-button" href="https://dedi4.nedprod.com/static/files/outcome-v2.0-source-latest.tar.xz" data-icon="octicon-cloud-download" aria-label="Download Outcome">Download</a>


<a class="github-button" href="https://github.com/ned14/outcome" data-icon="octicon-star" data-show-count="false" aria-label="Star Outcome on GitHub">Star</a>


<a class="github-button" href="https://github.com/ned14/outcome/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork Outcome on GitHub">Fork</a>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </div>
</nav>



        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
        
          <div id="top-bar">
            
              
              
              
            <div id="top-github-link">
              <a class="github-link" href="https://github.com/ned14/outcome/edit/develop/doc/src/content/tutorial/_index.md" target="blank">
                <i class="fa fa-code-fork"></i>
                Edit page
              </a>
            </div><div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                <span id="sidebar-toggle-span">
                  <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                    <i class="fa fa-bars"></i>
                  </a>
                </span>
                <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                <span class="links">
                




 <a href='/outcome/'>Home</a> > Tutorial

 

   
                </span>
            </div>
            <div class="progress">
    <div class="wrapper">

    </div>
</div>

          </div>
        
        
        <div id="body-inner">
          
            <h1>Tutorial</h1>
          






<ol class="children children-li"><li>
	<a href="/outcome/tutorial/result/" >result&lt;T, EC&gt;</a></li>
<p>Gentle introduction to writing code with simple success-or-failure return types.</p>
<ul><li>
	<a href="/outcome/tutorial/result/inspecting/" >Inspecting result&lt;T, EC&gt;</a></li>
<p>Suppose we will be writing function print_half that takes an integral number (however big) represented as an std::string and outputs a number which is twice smaller:
outcome::result&lt;void&gt; print_half(const std::string&amp; text);  View this code on Github Type result&lt;void&gt; means that there is no value to be retuned upon success, but that the operation might still fail, and we may be interested in inspecting the cause of the failure. Class template result&lt;&gt; is declared with attribute [[nodiscard]], which means compiler will warn you if you forget to inspect the returned object (in C++ 17 or later).</p><li>
	<a href="/outcome/tutorial/result/try/" >TRY operations</a></li>
<p></p>
</ul><li>
	<a href="/outcome/tutorial/outcome/" >outcome&lt;T, EC, EP&gt;</a></li>
<p>Success-or-failure return types where failure can take two forms, expected failure and unexpected failure.</p>
<ul><li>
	<a href="/outcome/tutorial/outcome/inspecting/" >Inspecting outcome&lt;T, EC, EP&gt;</a></li>
<p></p>
</ul><li>
	<a href="/outcome/tutorial/payload/" >outcome&lt;T, EC, P&gt;</a></li>
<p>Success-or-failure return types where extra information accompanies failure.</p>
<ul><li>
	<a href="/outcome/tutorial/payload/copy_file/" >The Filesystem TS</a></li>
<p>To see how payload-transporting outcome might be useful, consider the copy_file() API from the Filesystem TS:
namespace filesystem { /*! Copies the file at path `from` to path `to`. \returns True if file was successfully copied. \throws On failure throws `filesystem_error(ec.message(), from, to, ec)` with `ec` being the error code reported by the operating system. */ bool copy_file(const path &amp;from, const path &amp;to); /*! Copies the file at path `from` to path `to`.</p><li>
	<a href="/outcome/tutorial/payload/copy_file2/" >Upgrading the Filesystem TS</a></li>
<p>An Outcome based solution looks deceptively simple initially, but there is more to it than it appears.
namespace filesystem2 { // Paths related to a failure. Also causes ADL discovery to check this namespace.  struct failure_info { path path1, path2; }; // Localise an outcome implementation specific to this namespace. Normally would just  // be `result`, but for clarity we&#39;ll use `fs_result`.  template &lt;class T&gt; using fs_result = outcome::outcome&lt;T, std::error_code, failure_info&gt;; /*!</p><li>
	<a href="/outcome/tutorial/payload/copy_file3/" >Throwing filesystem_error</a></li>
<p></p>
</ul><li>
	<a href="/outcome/tutorial/default-actions/" >Default actions</a></li>
<p>The default rules for handling different categories of failure type</p>
<ul><li>
	<a href="/outcome/tutorial/default-actions/udt-err/" >User defined error types</a></li>
<p>Let us imagine a some user defined value type (udt) and some user defined error type (err):
struct udt { int a{0}; explicit udt(int _a) : a(_a) { } udt() = default; int operator*() const { return a; } }; struct err { int a{0}; explicit err(int _a) : a(_a) { } err() = default; };  View this code on Github Firstly, note that both the udt and err types can be constructed from an int.</p><li>
	<a href="/outcome/tutorial/default-actions/happens1/" >-- What happens?</a></li>
<p>Let us run the code from the previous page:
ned@lyta:~/outcome/build_posix$ bin/outcome-snippets_udts Segmentation fault (core dumped) ned@lyta:~/outcome/build_posix$  Apparently no exception was thrown? Correct. Nor was a value printed, though this will randomly vary depending on your compiler, libraries, the wind blowing on the day &hellip;
You will probably find this surprising. This is because the default action for a user-defined error type is undefined behaviour.
Let&rsquo;s demonstrate this by recompiling the code to use the undefined behaviour sanitiser and see what happens instead:</p><li>
	<a href="/outcome/tutorial/default-actions/enums/" >Error code enums</a></li>
<p>Let&rsquo;s replace err with something likely in many people&rsquo;s code, a strongly typed enum:
struct udt { int a{0}; explicit udt(int _a) : a(_a) { } udt() = default; int operator*() const { return a; } }; enum class err { success, failure1, failure2 }; result&lt;udt, err&gt; res(err::failure1); // What happens here? What exception type is thrown?  try { std::cout &lt;&lt; *res.value() &lt;&lt; std::endl; } catch(const std::exception &amp;e) { std::cerr &lt;&lt; &#34;Exception thrown was &#34; &lt;&lt; e.</p><li>
	<a href="/outcome/tutorial/default-actions/happens2/" >-- What happens?</a></li>
<p></p><li>
	<a href="/outcome/tutorial/default-actions/happens3/" >-- Now what happens?</a></li>
<p>Let us run the code from the previous page:
ned@lyta:~/outcome/build_posix$ bin/outcome-snippets_error_code_enums2 Exception thrown was failure1 ned@lyta:~/outcome/build_posix$  Ah so now we are throwing a C++ exception on incorrect observation! This is because we registered our error code enum with the C++ standard library and in so doing, we also told the standard library how our error code interacts with std::error_code and thus std::system_error.
Outcome&rsquo;s default action when incorrectly observing a result or outcome with a EC type where std::is_error_code_enum&lt;EC&gt; is true, or std::is_error_condition_enum&lt;EC&gt; is true, is to throw a std::system_error(make_error_code(.</p><li>
	<a href="/outcome/tutorial/default-actions/error-codes/" >error_code</a></li>
<p></p><li>
	<a href="/outcome/tutorial/default-actions/exception-ptr/" >exception_ptr</a></li>
<p></p><li>
	<a href="/outcome/tutorial/default-actions/void/" >void</a></li>
<p></p><li>
	<a href="/outcome/tutorial/default-actions/unchecked/" >unchecked&lt;T, E&gt; and checked&lt;T, E&gt;</a></li>
<p></p>
</ul><li>
	<a href="/outcome/tutorial/hooks/" >Hooking events</a></li>
<p>Intercepting useful events such as initial construction, copies and moves so you can capture backtraces, fire debug breakpoints etc.</p>
<ul><li>
	<a href="/outcome/tutorial/hooks/keeping_state/" >Keeping state</a></li>
<p>The first thing we are going to need is somewhere to store the stack backtrace. We could take the easier route and simply store it into an allocated block and keep the pointer as a custom payload in an outcome&lt;T, error_code, std::unique_ptr&lt;stack_backtrace&gt;&gt; (see previous section on outcome&lt;T, EC, P&gt;). But let us assume that we care so deeply about bounded execution times that ever calling malloc is unacceptable.
We therefore are going to need some completely static and trivially typed storage perhaps kept per-thread to avoid the need to keep mutexes.</p><li>
	<a href="/outcome/tutorial/hooks/adl_bridging/" >ADL bridging</a></li>
<p>In the previous section outcome&lt;T, EC, P&gt;, we used the failure_info type to create the ADL bridge into the namespace where the ADL discovered throw_as_system_error_with_payload() function was to be found.
Here we do the same, but more directly by creating a thin clone of std::error_code into the local namespace. This ensures that this namespace will be searched by the compiler when discovering the event hooks.
namespace error_code_extended { // Use the error_code type as the ADL bridge for the hooks by creating a type here  // It can be any type that your localised result uses, including the value type but  // by localising the error code type here you prevent nasty surprises later when the  // value type you use doesn&#39;t trigger the ADL bridge.</p><li>
	<a href="/outcome/tutorial/hooks/hook_result/" >Hook result</a></li>
<p></p><li>
	<a href="/outcome/tutorial/hooks/poke_exception/" >Custom exception ptr</a></li>
<p></p><li>
	<a href="/outcome/tutorial/hooks/hook_outcome/" >Hook outcome</a></li>
<p></p>
</ul><li>
	<a href="/outcome/tutorial/policies/" >Policies</a></li>
<p>Defining your own NoValuePolicy policies, plus an overview of the precanned policies which come in the Outcome source code.</p>
<ul><li>
	<a href="/outcome/tutorial/policies/anatomy/" >Anatomy of a policy</a></li>
<p>A NoValuePolicy is quite simple. This is a complete policy, only the top half is needed if you never use the policy in an outcome.
struct blank_policy { //! Performs a narrow check of state, used in the assume_value() functions.  template &lt;class Impl&gt; static constexpr void narrow_value_check(Impl *self) noexcept; //! Performs a narrow check of state, used in the assume_error() functions.  template &lt;class Impl&gt; static constexpr void narrow_error_check(Impl *self) noexcept; //!</p><li>
	<a href="/outcome/tutorial/policies/cast/" >Casting workaround</a></li>
<p>The templated Impl type on each policy function is decltype(*this) of the part of Outcome&rsquo;s internal implementation which calls the policy. It may also be const, depending on the observer called. It is highly unlikely to be result&lt;T, EC&gt; or especially outcome&lt;T, EC, EP|P&gt;, so a very common thing you&rsquo;ll need to do is static cast to a more derived form before use like this:
template &lt;class R, class S, class P&gt; struct outcome_policy { /*!</p><li>
	<a href="/outcome/tutorial/policies/universal/" >Result &#43; Outcome</a></li>
<p>These are the precanned policies suitable for use with both result and outcome:
 all_narrow Wide checks call their narrow check cousins only. Narrow checks call __builtin_unreachable() on compilers which support that intrinsic. terminate Wide checks call std::terminate if they fail. Narrow checks call __builtin_unreachable() on compilers which support that intrinsic.  </p><li>
	<a href="/outcome/tutorial/policies/result-policies/" >Result</a></li>
<p></p>
</ul><li>
	<a href="/outcome/tutorial/error_code/" >Custom error codes</a></li>
<p>Illustrates how you can hook into the std::error_code system from the Standard Library in order to work with your own set of error codes.</p>
<ul>
</ul>
</ol>







<footer class=" footline" >
	
</footer>






        

      </div>
    </div>

    
 
    

    <div id="navigation">
        <a class="nav nav-prev" href="/outcome/build/" title="Build and install"> <i class="fa fa-chevron-left"></i></a>
        <a class="nav nav-next" href="/outcome/tutorial/result/" title="result&lt;T, EC&gt;" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
    </div>

    </section>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>    

    <script src="/outcome/js/clipboard.min.js"></script>
<script src="/outcome/js/featherlight.min.js"></script>
<script src="/outcome/js/html5shiv-printshiv.min.js"></script>


<script src="/outcome/js/modernizr.custom.71422.js"></script>
<script src="/outcome/js/learn.js"></script>
<script src="/outcome/js/hugo-learn.js"></script>


<link href="/outcome/mermaid/mermaid.css" type="text/css" rel="stylesheet"/>
<script src="/outcome/mermaid/mermaid.js"></script>
<script>mermaid.initialize({startOnLoad:true});</script>
    

  </body>
</html>
